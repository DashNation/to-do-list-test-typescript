import*as storage from"./storage.js";let addBtn=document.getElementById("addBtn"),editBtn=document.getElementById("editBtn"),removeBtn=document.getElementById("removeBtn"),todoValueInputField=document.getElementById("todoValueInputField"),noteList=document.getElementById("noteList"),noteCount=0,isEditActive=!1,isRemoveActive=!1,isFillerTextVisible=!0;window.addEventListener("keydown",e=>{"e"===e.key.toLocaleLowerCase()&&e.altKey&&((isEditActive=!isEditActive)?editBtn.classList.add("active"):editBtn.classList.remove("active"))}),window.addEventListener("keydown",e=>{"r"===e.key.toLocaleLowerCase()&&e.altKey&&((isRemoveActive=!isRemoveActive)?(removeBtn.classList.add("active"),(isFillerTextVisible?removeRemoveNoteBtns:addRemoveNoteBtns)()):(removeBtn.classList.remove("active"),isFillerTextVisible||removeRemoveNoteBtns()))});class Note{note;id;constructor(e){this.note=todoValueInputField.value.trim(),this.id=noteCount++}addNote(){var e,t;""!==this.note&&((e=document.createElement("div")).classList.add("noteListItemWrapper"),e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="start",e.style.alignItems="center",e.style.width="100%",e.style.height="100%",noteList.appendChild(e),(t=document.createElement("li")).classList.add("listElement"),t.innerHTML=this.note,t.id=""+this.id,storage.add("note"+this.id,this.note),e.appendChild(t))}static editNote(e){let t=document.createElement("div"),s=(t.id="userInputWrapper",t.style.display="flex",t.style.flexDirection="row",t.style.alignItems="center",t.style.justifyContent="space-between",t.style.gap="0.05rem",noteList.appendChild(t),e.textContent||""),i=document.createElement("input"),n=(i.value=s,i.id="userInputField",i.classList.add("userInputField"),i.type="text",document.createElement("button"));n.classList.add("checkBtn"),n.classList.add("btn");var d=document.createElement("img");d.src="SVG/checkMark24.svg",d.classList.add("check"),n.appendChild(d);let o=document.createElement("button");o.classList.add("crossBtn"),o.classList.add("btn");d=document.createElement("img");function l(){var e=document.createElement("li");e.value;e.textContent=i.value,e.classList.add("listElement"),t.replaceWith(e),n.remove(),o.remove()}function a(e){var t=document.createElement("li");t.textContent=e,t.classList.add("listElement"),i.replaceWith(t),n.remove(),o.remove()}d.src="SVG/cross50.svg",d.classList.add("cross"),o.appendChild(d),t.appendChild(i),t.appendChild(n),t.appendChild(o),e.replaceWith(t),i.focus();let c=!1;n.addEventListener("mousedown",()=>{c=!0,l()}),o.addEventListener("mousedown",()=>{c=!0,a(s)}),i.addEventListener("keydown",e=>{c||("Enter"===e.key&&l(),"Escape"===e.key&&(console.log("Escape Pressed!"),a(s)))}),i.addEventListener("blur",()=>{c||l()})}}function ClickAddNoteHandler(){""!==todoValueInputField.value&&(new Note(todoValueInputField.value).addNote(),todoValueInputField.value="",checkNodeListChildren())}addBtn.addEventListener("click",e=>{e.preventDefault(),ClickAddNoteHandler()}),editBtn.addEventListener("click",e=>{(isEditActive=!isEditActive)?editBtn.classList.add("active"):editBtn.classList.remove("active")}),removeBtn.addEventListener("click",e=>{((isRemoveActive=!isRemoveActive)?(removeBtn.classList.add("active"),isFillerTextVisible?removeRemoveNoteBtns:addRemoveNoteBtns):(removeBtn.classList.remove("active"),removeRemoveNoteBtns))()}),todoValueInputField.addEventListener("keyup",e=>{"Enter"===e.key&&(e.preventDefault(),ClickAddNoteHandler())}),document.addEventListener("DOMContentLoaded",checkNodeListChildren),document.addEventListener("change",checkNodeListChildren);let emptyListMsg=document.createElement("p");function checkNodeListChildren(){0===noteList.querySelectorAll("li").length?(noteList.contains(emptyListMsg)||((emptyListMsg=document.createElement("p")).innerHTML="No thoughts collected...",emptyListMsg.id="emptyListTxt",noteList.appendChild(emptyListMsg)),isFillerTextVisible=!0,emptyListMsg.style.display="block"):(noteList.contains(emptyListMsg)&&noteList.removeChild(emptyListMsg),isFillerTextVisible=!1,emptyListMsg.style.display="none")}function editBtnClickHandler(e){"LI"===e.tagName&&Note.editNote(e)}function addRemoveNoteBtns(){Array.from(noteList.children).forEach(e=>{var t=document.createElement("button"),s=(t.classList.add("btn"),t.classList.add("removeNoteBtn"),t.style.justifyContent="center",removeBtn.style.alignItems="center",document.createElement("img"));s.src="SVG/minus.svg",s.classList.add("minus"),t.appendChild(s),e.appendChild(t),t.addEventListener("click",e=>{var e=e.target;e&&(e=e.closest(".noteListItemWrapper"))&&(e.remove(),checkNodeListChildren())})})}function removeRemoveNoteBtns(){Array.from(noteList.children).forEach(e=>{e=e.querySelector(".removeNoteBtn");e&&e.remove()})}function loadNotesFromLocalStorage(){var t=storage.getFilteredBy("note");if(0!==t.length)for(let e=0;e<t.length;e++){console.log(storage.get(t[e]));var s=storage.get(t[e]);todoValueInputField.value=s,ClickAddNoteHandler()}}noteList.addEventListener("dblclick",e=>{e=e.target.closest("li");e&&noteList.contains(e)&&(e.classList.contains("selectedItem")?e.classList.remove("selectedItem"):e.classList.add("selectedItem"),isEditActive)&&e.classList.contains("selectedItem")&&editBtnClickHandler(e)}),document.addEventListener("DOMContentLoaded",()=>{loadNotesFromLocalStorage()});