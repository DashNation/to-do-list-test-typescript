import*as storage from"./storage.js";let addBtn=document.getElementById("addBtn"),editBtn=document.getElementById("editBtn"),removeBtn=document.getElementById("removeBtn"),todoValueInputField=document.getElementById("todoValueInputField"),noteList=document.getElementById("noteList"),noteCount=0,isEditActive=!1,isRemoveActive=!1,isFillerTextVisible=!0;window.addEventListener("keydown",e=>{"e"===e.key.toLocaleLowerCase()&&e.altKey&&((isEditActive=!isEditActive)?editBtn.classList.add("active"):editBtn.classList.remove("active"))}),window.addEventListener("keydown",e=>{"r"===e.key.toLocaleLowerCase()&&e.altKey&&((isRemoveActive=!isRemoveActive)?(removeBtn.classList.add("active"),(isFillerTextVisible?closeRemoveNoteBtns:addRemoveNoteBtns)()):(removeBtn.classList.remove("active"),isFillerTextVisible||closeRemoveNoteBtns()))});class Note{note;id;constructor(e){this.note=todoValueInputField.value.trim(),this.id=noteCount++}addNote(){var e,t;this.note&&((e=document.createElement("div")).classList.add("noteListItemWrapper"),e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="start",e.style.alignItems="center",e.style.width="100%",e.style.height="100%",noteList.appendChild(e),(t=document.createElement("li")).classList.add("listElement"),t.innerHTML=this.note,t.id=""+this.id,storage.add(""+this.id,this.note),e.appendChild(t))}static editNote(e){let t=e.id,s=(console.log("targetID",t),document.createElement("div")),n=(s.id="userInputWrapper",s.style.display="flex",s.style.flexDirection="row",s.style.alignItems="center",s.style.justifyContent="space-between",s.style.gap="0.05rem",noteList.appendChild(s),e.textContent||""),i=document.createElement("input"),d=(i.value=n,i.focus(),i.select(),i.id="userInputField",i.classList.add("userInputField"),i.type="text",document.createElement("button"));d.classList.add("checkBtn"),d.classList.add("btn");var o=document.createElement("img");o.src="SVG/checkMark24.svg",o.classList.add("check"),d.appendChild(o);let l=document.createElement("button");l.classList.add("crossBtn"),l.classList.add("btn");o=document.createElement("img");function a(){var e=document.createElement("li");e.value;storage.edit(""+t,i.value),e.textContent=i.value,e.id=t,e.classList.add("listElement"),s.replaceWith(e),d.remove(),l.remove()}function c(e){var t=document.createElement("li");t.textContent=e,t.classList.add("listElement"),i.replaceWith(t),d.remove(),l.remove()}o.src="SVG/cross50.svg",o.classList.add("cross"),l.appendChild(o),s.appendChild(i),s.appendChild(d),s.appendChild(l),e.replaceWith(s),i.focus();let r=!1;d.addEventListener("mousedown",()=>{r=!0,a()}),l.addEventListener("mousedown",()=>{r=!0,c(n)}),i.addEventListener("keydown",e=>{r||("Enter"===e.key&&a(),"Escape"===e.key&&(console.log("Escape Pressed!"),c(n)))}),i.addEventListener("blur",()=>{r||a()})}}function ClickAddNoteHandler(){""!==todoValueInputField.value&&(new Note(todoValueInputField.value).addNote(),todoValueInputField.value="",checkNodeListChildren())}addBtn.addEventListener("click",e=>{e.preventDefault(),ClickAddNoteHandler()}),editBtn.addEventListener("click",e=>{(isEditActive=!isEditActive)?editBtn.classList.add("active"):editBtn.classList.remove("active")}),removeBtn.addEventListener("click",e=>{((isRemoveActive=!isRemoveActive)?(removeBtn.classList.add("active"),isFillerTextVisible?closeRemoveNoteBtns:addRemoveNoteBtns):(removeBtn.classList.remove("active"),closeRemoveNoteBtns))()}),todoValueInputField.addEventListener("keyup",e=>{"Enter"===e.key&&(e.preventDefault(),ClickAddNoteHandler())}),document.addEventListener("DOMContentLoaded",checkNodeListChildren),document.addEventListener("change",checkNodeListChildren);let emptyListMsg=document.createElement("p");function checkNodeListChildren(){0===noteList.querySelectorAll("li").length?(noteList.contains(emptyListMsg)||((emptyListMsg=document.createElement("p")).innerHTML="No thoughts collected...",emptyListMsg.id="emptyListTxt",noteList.appendChild(emptyListMsg)),isFillerTextVisible=!0,emptyListMsg.style.display="block"):(noteList.contains(emptyListMsg)&&noteList.removeChild(emptyListMsg),isFillerTextVisible=!1,emptyListMsg.style.display="none")}function editBtnClickHandler(e){"LI"===e.tagName&&Note.editNote(e)}function addRemoveNoteBtns(){Array.from(noteList.children).forEach(e=>{var t=document.createElement("button"),s=(t.classList.add("btn"),t.classList.add("removeNoteBtn"),t.style.justifyContent="center",removeBtn.style.alignItems="center",document.createElement("img"));s.src="SVG/minus.svg",s.classList.add("minus"),t.appendChild(s),e.appendChild(t),t.addEventListener("click",e=>{var t,e=e.target;e&&(e=e.closest(".noteListItemWrapper"))&&(t=e.querySelector(".listElement")?.id,console.log("noteID when deleting stuff",t),storage.remove(""+t),e.remove(),checkNodeListChildren())})})}function closeRemoveNoteBtns(){Array.from(noteList.children).forEach(e=>{e=e.querySelector(".removeNoteBtn");e&&e.remove()})}function loadLocalStorageKeys(){var t=storage.loadLocalStorage();if(0!==t.length)for(let e=0;e<t.length;e++){console.log(storage.get(t[e]));var s=storage.get(t[e]);todoValueInputField.value=s,ClickAddNoteHandler()}}function reset(){storage.clear(),todoValueInputField.value="",todoValueInputField.placeholder="reset successful!",todoValueInputField.style.color="#2cff2cff",noteList.querySelectorAll(".noteListItemWrapper").forEach(e=>e.remove()),checkNodeListChildren()}noteList.addEventListener("dblclick",e=>{e=e.target.closest("li");e&&noteList.contains(e)&&(e.classList.contains("selectedItem")?e.classList.remove("selectedItem"):e.classList.add("selectedItem"),isEditActive)&&e.classList.contains("selectedItem")&&editBtnClickHandler(e)}),document.addEventListener("DOMContentLoaded",()=>{loadLocalStorageKeys()}),todoValueInputField.addEventListener("keydown",e=>{"Enter"===e.key&&"//reset"==todoValueInputField.value&&reset()}),todoValueInputField.addEventListener("input",()=>{"//reset"===todoValueInputField.value?todoValueInputField.style.color="#ff1818ff":(todoValueInputField.style.color="#ffffff",todoValueInputField.placeholder="enter your thoughts here")});